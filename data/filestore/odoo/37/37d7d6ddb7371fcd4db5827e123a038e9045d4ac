)]}'
{"version": 3, "sources": ["/web/static/tests/legacy/helpers/test_utils_file.js", "/mail/static/tests/tours/mail_channel_as_guest_tour.js", "/mail/static/tests/tours/mail_full_composer_test_tour.js", "/portal/static/tests/tours/portal.js", "/auth_totp/static/tests/totp_flow.js", "/auth_totp_mail/static/tests/totp_flow.js", "/auth_totp_portal/static/tests/totp_portal.js", "/documents_spreadsheet/static/tests/tours/create_empty_sheet_tour.js", "/documents_spreadsheet/static/tests/tours/open_pivot_sheet_tour.js", "/mail_enterprise/static/tests/tours/mail_channel_expand_test_tour.js"], "mappings": "AAAA;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9JA;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC/BA;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACtFA;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtBA;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpTA;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3FA;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5HA;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnGA;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5EA;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA", "sourcesContent": ["odoo.define('web.test_utils_file', function () {\n\"use strict\";\n\n/**\n * FILE Test Utils\n *\n * This module defines various utility functions to help simulate events with\n * files, such as drag-and-drop.\n *\n * Note that all methods defined in this module are exported in the main\n * testUtils file.\n */\n\n\n//------------------------------------------------------------------------------\n// Private functions\n//------------------------------------------------------------------------------\n\n/**\n * Create a fake object 'dataTransfer', linked to some files, which is passed to\n * drag and drop events.\n *\n * @param {Object[]} files\n * @returns {Object}\n */\nfunction _createFakeDataTransfer(files) {\n    return {\n        dropEffect: 'all',\n        effectAllowed: 'all',\n        files,\n        getData: function () {\n            return files;\n        },\n        items: [],\n        types: ['Files'],\n    };\n}\n\n//------------------------------------------------------------------------------\n// Public functions\n//------------------------------------------------------------------------------\n\n/**\n * Create a file object, which can be used for drag-and-drop.\n *\n * @param {Object} data\n * @param {string} data.name\n * @param {string} data.content\n * @param {string} data.contentType\n * @returns {Promise<Object>} resolved with file created\n */\nfunction createFile(data) {\n    // Note: this is only supported by Chrome, and does not work in Incognito mode\n    return new Promise(function (resolve, reject) {\n        var requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem;\n        if (!requestFileSystem) {\n            throw new Error('FileSystem API is not supported');\n        }\n        requestFileSystem(window.TEMPORARY, 1024 * 1024, function (fileSystem) {\n            fileSystem.root.getFile(data.name, { create: true }, function (fileEntry) {\n                fileEntry.createWriter(function (fileWriter) {\n                    fileWriter.onwriteend = function (e) {\n                        fileSystem.root.getFile(data.name, {}, function (fileEntry) {\n                            fileEntry.file(function (file) {\n                                resolve(file);\n                            });\n                        });\n                    };\n                    fileWriter.write(new Blob([ data.content ], { type: data.contentType }));\n                });\n            });\n        });\n    });\n}\n\n/**\n * Drag a file over a DOM element\n *\n * @param {$.Element} $el\n * @param {Object} file must have been created beforehand (@see createFile)\n */\nfunction dragoverFile($el, file) {\n    var ev = new Event('dragover', { bubbles: true });\n    Object.defineProperty(ev, 'dataTransfer', {\n        value: _createFakeDataTransfer(file),\n    });\n    $el[0].dispatchEvent(ev);\n}\n\n/**\n * Drop a file on a DOM element.\n *\n * @param {$.Element} $el\n * @param {Object} file must have been created beforehand (@see createFile)\n */\nfunction dropFile($el, file) {\n    var ev = new Event('drop', { bubbles: true, });\n    Object.defineProperty(ev, 'dataTransfer', {\n        value: _createFakeDataTransfer([file]),\n    });\n    $el[0].dispatchEvent(ev);\n}\n\n/**\n * Drop some files on a DOM element.\n *\n * @param {$.Element} $el\n * @param {Object[]} files must have been created beforehand (@see createFile)\n */\nfunction dropFiles($el, files) {\n    var ev = new Event('drop', { bubbles: true, });\n    Object.defineProperty(ev, 'dataTransfer', {\n        value: _createFakeDataTransfer(files),\n    });\n    $el[0].dispatchEvent(ev);\n}\n\n/**\n * Set files in a file input\n *\n * @param {DOM.Element} el\n * @param {Object[]} files must have been created beforehand\n *   @see testUtils.file.createFile\n */\nfunction inputFiles(el, files) {\n    // could not use _createFakeDataTransfer as el.files assignation will only\n    // work with a real FileList object.\n    const dataTransfer = new window.DataTransfer();\n    for (const file of files) {\n        dataTransfer.items.add(file);\n    }\n    el.files = dataTransfer.files;\n    /**\n     * Changing files programatically is not supposed to trigger the event but\n     * it does in Chrome versions before 73 (which is on runbot), so in that\n     * case there is no need to make a manual dispatch, because it would lead to\n     * the files being added twice.\n     */\n    const versionRaw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n    const chromeVersion = versionRaw ? parseInt(versionRaw[2], 10) : false;\n    if (!chromeVersion || chromeVersion >= 73) {\n        el.dispatchEvent(new Event('change'));\n    }\n}\n\n//------------------------------------------------------------------------------\n// Exposed API\n//------------------------------------------------------------------------------\n\nreturn {\n    createFile: createFile,\n    dragoverFile: dragoverFile,\n    dropFile: dropFile,\n    dropFiles,\n    inputFiles,\n};\n\n});\n", "/** @odoo-module **/\n\nimport tour from 'web_tour.tour';\n\ntour.register('mail/static/tests/tours/mail_channel_as_guest_tour.js', {\n    test: true,\n}, [{\n    content: \"Click join\",\n    trigger: '.o_WelcomeView_joinButton',\n    extraTrigger: '.o_ThreadView',\n}, {\n    content: \"Check that we are on channel page\",\n    trigger: '.o_ThreadView',\n    run() {\n        if (!window.location.pathname.startsWith('/discuss/channel')) {\n            console.error('Clicking on join button did not redirect to channel page');\n        }\n        // Wait for modules to be loaded or failed for the next step\n        odoo.__DEBUG__.didLogInfo.then(() => {\n            const { missing, failed, unloaded } = odoo.__DEBUG__.jsModules;\n            if ([missing, failed, unloaded].some(arr => arr.length)) {\n                console.error(\"Couldn't load all JS modules.\", JSON.stringify({ missing, failed, unloaded }));\n            }\n            document.body.classList.add('o_mail_channel_as_guest_tour_modules_loaded');\n        });\n    },\n    extraTrigger: '.o_mail_channel_as_guest_tour_modules_loaded',\n}, {\n    content: \"Wait for all modules loaded check in previous step\",\n    trigger: '.o_mail_channel_as_guest_tour_modules_loaded',\n}]);\n", "/** @odoo-module **/\n\nimport {\n    createFile,\n    inputFiles,\n} from 'web.test_utils_file';\n\nimport tour from 'web_tour.tour';\n\n/**\n * This tour depends on data created by python test in charge of launching it.\n * It is not intended to work when launched from interface. It is needed to test\n * an action (action manager) which is not possible to test with QUnit.\n * @see mail/tests/test_mail_full_composer.py\n */\ntour.register('mail/static/tests/tours/mail_full_composer_test_tour.js', {\n    test: true,\n}, [{\n    content: \"Click on Send Message\",\n    trigger: '.o_ChatterTopbar_buttonSendMessage',\n}, {\n    content: \"Write something in composer\",\n    trigger: '.o_ComposerTextInput_textarea',\n    run: 'text blahblah',\n}, {\n    content: \"Add one file in composer\",\n    trigger: '.o_Composer_buttonAttachment',\n    async run() {\n        const file = await createFile({\n            content: 'hello, world',\n            contentType: 'text/plain',\n            name: 'text.txt',\n        });\n        inputFiles(\n            document.querySelector('.o_FileUploader_input'),\n            [file]\n        );\n    },\n}, {\n    content: \"Open full composer\",\n    trigger: '.o_Composer_buttonFullComposer',\n    extra_trigger: '.o_AttachmentCard:not(.o-isUploading)' // waiting the attachment to be uploaded\n}, {\n    content: \"Check the earlier provided attachment is listed\",\n    trigger: '.o_AttachmentCard[title=\"text.txt\"]',\n    run() {},\n}, {\n    content: \"Check subject is autofilled\",\n    trigger: 'input[name=\"subject\"]',\n    run() {\n        const subjectValue = document.querySelector('input[name=\"subject\"]').value;\n        if (subjectValue !== \"Re: Test User\") {\n            console.error(\n                `Full composer should have \"Re: Test User\" in subject input (actual: ${subjectValue})`\n            );\n        }\n    },\n}, {\n    content: \"Check composer content is kept\",\n    trigger: '.oe_form_field[name=\"body\"]',\n    run() {\n        const bodyContent = document.querySelector('.oe_form_field[name=\"body\"]').textContent;\n        if (!bodyContent.includes(\"blahblah\")) {\n            console.error(\n                `Full composer should contain text from small composer (\"blahblah\") in body input (actual: ${bodyContent})`\n            );\n        }\n    },\n}, {\n    content: \"Open templates\",\n    trigger: '.o_field_widget[name=\"template_id\"] input',\n}, {\n    content: \"Check a template is listed\",\n    in_modal: false,\n    trigger: '.ui-autocomplete .ui-menu-item a:contains(\"Test template\")',\n    run() {},\n}, {\n    content: \"Send message\",\n    trigger: '.o_mail_send',\n}, {\n    content: \"Check message is shown\",\n    trigger: '.o_Message:contains(\"blahblah\")',\n}, {\n    content: \"Check message contains the attachment\",\n    trigger: '.o_Message .o_AttachmentCard_filename:contains(\"text.txt\")',\n}]);\n", "odoo.define('portal.tour', function (require) {\n'use strict';\n\nvar tour = require(\"web_tour.tour\");\n\ntour.register('portal_load_homepage', {\n    test: true,\n    url: '/my',\n},\n    [\n        {\n            content: \"Check portal is loaded\",\n            trigger: 'a[href*=\"/my/account\"]:contains(\"Edit\"):first',\n        },\n        {\n            content: \"Load my account details\",\n            trigger: 'input[value=\"Joel Willis\"]'\n        }\n    ]\n);\n\n});\n", "odoo.define('auth_totp.tours', function(require) {\n\"use strict\";\n\nconst tour = require('web_tour.tour');\nconst ajax = require('web.ajax');\n\nfunction openRoot() {\n    return [{\n        content: \"return to client root to avoid race condition\",\n        trigger: 'body',\n        run() {\n            $('body').addClass('wait');\n            window.location = '/web';\n        }\n    }, {\n        content: \"wait for client reload\",\n        trigger: 'body:not(.wait)',\n        run() {}\n    }];\n}\nfunction openUserProfileAtSecurityTab() {\n    return [{\n        content: 'Open user account menu',\n        trigger: '.o_user_menu .oe_topbar_name',\n        run: 'click',\n    }, {\n        content: \"Open preferences / profile screen\",\n        trigger: '[data-menu=settings]',\n        run: 'click',\n    }, {\n        content: \"Switch to security tab\",\n        trigger: 'a[role=tab]:contains(\"Account Security\")',\n        run: 'click',\n    }];\n}\n\ntour.register('totp_tour_setup', {\n    test: true,\n    url: '/web'\n}, [...openUserProfileAtSecurityTab(), {\n    content: \"Open totp wizard\",\n    trigger: 'button[name=action_totp_enable_wizard]',\n}, {\n    content: \"Check that we have to enter enhanced security mode\",\n    trigger: 'div:contains(\"enter your password\")',\n    run: () => {},\n}, {\n    content: \"Input password\",\n    trigger: '[name=password]',\n    run: 'text demo', // FIXME: better way to do this?\n}, {\n    content: \"Confirm\",\n    trigger: \"button:contains(Confirm Password)\",\n}, {\n    content: \"Check the wizard has opened\",\n    trigger: 'li:contains(\"When requested to do so\")',\n    run: () => {}\n}, {\n    content: \"Get secret from collapsed div\",\n    trigger: 'a:contains(\"Cannot scan it?\")',\n    run(helpers) {\n        const $secret = this.$anchor.closest('div').find('span[name=secret]');\n        const $copyBtn = $secret.find('button');\n        $copyBtn.remove();\n        const secret = $secret.text();\n        ajax.jsonRpc('/totphook', 'call', {\n            secret\n        }).then((token) => {\n            helpers._text(helpers._get_action_values('input[name=code]'), token);\n            helpers._click(helpers._get_action_values('button.btn-primary:contains(Activate)'));\n            $('body').addClass('got-token')\n        });\n    }\n}, {\n    content: 'wait for rpc',\n    trigger: 'body.got-token',\n    run() {}\n},\n...openRoot(),\n...openUserProfileAtSecurityTab(),\n{\n    content: \"Check that the button has changed\",\n    trigger: 'button[name=action_totp_disable]',\n    run: () => {}\n}]);\n\ntour.register('totp_login_enabled', {\n    test: true,\n    url: '/'\n}, [{\n    content: \"check that we're on the login page or go to it\",\n    trigger: 'input#login, a:contains(Sign in)'\n}, {\n    content: \"input login\",\n    trigger: 'input#login',\n    run: 'text demo',\n}, {\n    content: 'input password',\n    trigger: 'input#password',\n    run: 'text demo',\n}, {\n    content: \"click da button\",\n    trigger: 'button:contains(\"Log in\")',\n}, {\n    content: \"expect totp screen\",\n    trigger: 'label:contains(Authentication Code)',\n}, {\n    content: \"input code\",\n    trigger: 'input[name=totp_token]',\n    run(helpers) {\n        ajax.jsonRpc('/totphook', 'call', {}).then((token) => {\n            helpers._text(helpers._get_action_values(), token);\n            // FIXME: is there a way to put the button as its own step trigger without\n            //        the tour straight blowing through and not waiting for this?\n            helpers._click(helpers._get_action_values('button:contains(\"Login\")'));\n        });\n    }\n}, {\n    content: \"check we're logged in\",\n    trigger: \".o_user_menu .oe_topbar_name\",\n    run: () => {}\n}]);\n\ntour.register('totp_login_device', {\n    test: true,\n    url: '/'\n}, [{\n    content: \"check that we're on the login page or go to it\",\n    trigger: 'input#login, a:contains(Sign in)'\n}, {\n    content: \"input login\",\n    trigger: 'input#login',\n    run: 'text demo',\n}, {\n    content: 'input password',\n    trigger: 'input#password',\n    run: 'text demo',\n}, {\n    content: \"click da button\",\n    trigger: 'button:contains(\"Log in\")',\n}, {\n    content: \"expect totp screen\",\n    trigger: 'label:contains(Authentication Code)',\n}, {\n    content: \"check remember device box\",\n    trigger: 'label[for=switch-remember]',\n}, {\n    content: \"input code\",\n    trigger: 'input[name=totp_token]',\n    run(helpers) {\n        ajax.jsonRpc('/totphook', 'call', {}).then((token) => {\n            helpers._text(helpers._get_action_values(), token);\n            // FIXME: is there a way to put the button as its own step trigger without\n            //        the tour straight blowing through and not waiting for this?\n            helpers._click(helpers._get_action_values('button:contains(\"Login\")'));\n        });\n    }\n}, {\n    content: \"check we're logged in\",\n    trigger: \".o_user_menu .oe_topbar_name\",\n    run: 'click',\n}, {\n    content: \"click the Log out button\",\n    trigger: '.dropdown-item[data-menu=logout]',\n}, {\n    content: \"check that we're back on the login page or go to it\",\n    trigger: 'input#login, a:contains(Log in)'\n}, {\n    content: \"input login again\",\n    trigger: 'input#login',\n    run: 'text demo',\n}, {\n    content: 'input password again',\n    trigger: 'input#password',\n    run: 'text demo',\n}, {\n    content: \"click da button again\",\n    trigger: 'button:contains(\"Log in\")',\n},  {\n    content: \"check we're logged in without 2FA\",\n    trigger: \".o_user_menu .oe_topbar_name\",\n    run: () => {}\n},\n// now go and disable two-factor authentication would be annoying to do in a separate tour\n// because we'd need to login & totp again as HttpCase.authenticate can't\n// succeed w/ totp enabled\n...openUserProfileAtSecurityTab(),\n{\n    content: \"Open totp wizard\",\n    trigger: 'button[name=action_totp_disable]',\n}, {\n    content: \"Check that we have to enter enhanced security mode\",\n    trigger: 'div:contains(\"enter your password\")',\n    run: () => {},\n}, {\n    content: \"Input password\",\n    trigger: '[name=password]',\n    run: 'text demo', // FIXME: better way to do this?\n}, {\n    content: \"Confirm\",\n    trigger: \"button:contains(Confirm Password)\",\n},\n...openRoot(),\n...openUserProfileAtSecurityTab(),\n{\n    content: \"Check that the button has changed\",\n    trigger: 'button[name=action_totp_enable_wizard]',\n    run: () => {}\n}]);\n\ntour.register('totp_login_disabled', {\n    test: true,\n    url: '/'\n}, [{\n    content: \"check that we're on the login page or go to it\",\n    trigger: 'input#login, a:contains(Sign in)'\n}, {\n    content: \"input login\",\n    trigger: 'input#login',\n    run: 'text demo',\n}, {\n    content: 'input password',\n    trigger: 'input#password',\n    run: 'text demo',\n}, {\n    content: \"click da button\",\n    trigger: 'button:contains(\"Log in\")',\n},\n// normally we'd end the tour here as it's all we care about but there are a\n// bunch of ongoing queries from the loading of the web client which cause\n// issues, so go and open the preferences / profile screen to make sure\n// everything settles down\n...openUserProfileAtSecurityTab(),\n]);\n\nconst columns = {};\ntour.register('totp_admin_disables', {\n    test: true,\n    url: '/web'\n}, [tour.stepUtils.showAppsMenuItem(), {\n    content: 'Go to settings',\n    trigger: '[data-menu-xmlid=\"base.menu_administration\"]'\n}, {\n    content: 'Wait for page',\n    trigger: '.o_menu_brand:contains(\"Settings\")',\n    run: () => {}\n}, {\n    content: \"Open Users menu\",\n    trigger: '[data-menu-xmlid=\"base.menu_users\"]'\n}, {\n    content: \"Open Users view\",\n    trigger: '[data-menu-xmlid=\"base.menu_action_res_users\"]',\n    run: function (helpers) {\n        // funny story: the users view we're trying to reach, sometimes we're\n        // already there, but if we re-click the next step executes before the\n        // action has the time to re-load, the one after that doesn't, and our\n        // selection get discarded by the action reloading, so here try to\n        // see if we're already on the users action through the breadcrumb and\n        // just close the menu if so\n        const $crumb = $('.breadcrumb');\n        if ($crumb.text().indexOf('Users') === -1) {\n            // on general settings page, click menu\n            helpers.click();\n        } else {\n            // else close menu\n            helpers.click($('[data-menu-xmlid=\"base.menu_users\"]'));\n        }\n    }\n}, {\n    content: \"Find Demo User\",\n    trigger: 'td.o_data_cell:contains(\"demo\")',\n    run: function (helpers) {\n        const $titles = this.$anchor.closest('table').find('tr:first th');\n        for (let i=0; i<$titles.length; ++i) {\n            columns[$titles[i].getAttribute('data-name')] = i;\n        }\n        const $row = this.$anchor.closest('tr');\n        const sel = $row.find('.o_list_record_selector input[type=checkbox]');\n        helpers.click(sel);\n    }\n}, {\n    content: \"Open Actions menu\",\n    trigger: 'button.dropdown-toggle:contains(\"Action\")'\n}, {\n    content: \"Select totp remover\",\n    trigger: 'a.dropdown-item:contains(Disable two-factor authentication)'\n}, { // enhanced security yo\n    content: \"Check that we have to enter enhanced security mode\",\ntrigger: 'div:contains(\"enter your password\")',\n    run: () => {},\n}, {\n    content: \"Input password\",\n    trigger: '[name=password]',\n    run: 'text admin', // FIXME: better way to do this?\n}, {\n    content: \"Confirm\",\n    trigger: \"button:contains(Confirm Password)\",\n}, {\n    content: \"open the user's form\",\n    trigger: \"td.o_data_cell:contains(demo)\",\n}, {\n    content: \"go to Account security Tab\",\n    trigger: \"a.nav-link:contains(Account Security)\",\n}, {\n    content: \"check that demo user has been de-totp'd\",\n    trigger: \"button[name=action_totp_enable_wizard]\",\n}])\n});\n", "odoo.define('auth_totp_mail.tours', function(require) {\n\"use strict\";\n\nconst tour = require('web_tour.tour');\n\nfunction openUserProfileAtSecurityTab() {\n    return [{\n        content: 'Open user account menu',\n        trigger: '.o_user_menu .oe_topbar_name',\n        run: 'click',\n    }, {\n        content: \"Open preferences / profile screen\",\n        trigger: '[data-menu=settings]',\n        run: 'click',\n    }, {\n        content: \"Switch to security tab\",\n        trigger: 'a[role=tab]:contains(\"Account Security\")',\n        run: 'click',\n    }];\n}\n\nfunction openAccountSettingsTab() {\n    return [{\n        content: 'Go to settings',\n        trigger: '[data-menu-xmlid=\"base.menu_administration\"]'\n    }, {\n        content: 'Wait for page',\n        trigger: '.o_menu_brand:contains(\"Settings\")',\n        run: () => {}\n    }, {\n        content: \"Open Users menu\",\n        trigger: '[data-menu-xmlid=\"base.menu_users\"]'\n    }, {\n        content: \"Open Users view\",\n        trigger: '[data-menu-xmlid=\"base.menu_action_res_users\"]',\n        run: function (helpers) {\n            // funny story: the users view we're trying to reach, sometimes we're\n            // already there, but if we re-click the next step executes before the\n            // action has the time to re-load, the one after that doesn't, and our\n            // selection get discarded by the action reloading, so here try to\n            // see if we're already on the users action through the breadcrumb and\n            // just close the menu if so\n            const $crumb = $('.breadcrumb');\n            if ($crumb.text().indexOf('Users') === -1) {\n                // on general settings page, click menu\n                helpers.click();\n            } else {\n                // else close menu\n                helpers.click($('[data-menu-xmlid=\"base.menu_users\"]'));\n            }\n        }\n    }];\n}\n\ntour.register('totp_admin_self_invite', {\n    test: true,\n    url: '/web'\n}, [tour.stepUtils.showAppsMenuItem(), ...openAccountSettingsTab(), {\n    content: \"open the user's form\",\n    trigger: \"td.o_data_cell:contains(admin)\",\n}, {\n    content: \"go to Account security Tab\",\n    trigger: \"a.nav-link:contains(Account Security)\",\n}, {\n    content: \"check that user cannot invite himself to use 2FA.\",\n    trigger: \"body\",\n    run: function () {\n        var $inviteBtn = $('button:contains(Invite to use 2FA)');\n        if ($inviteBtn.hasClass('o_invisible_modifier')) {\n            $('body').addClass('CannotInviteYourself');\n        }\n    }\n}, {\n    content: \"check that user cannot invite themself.\",\n    trigger: \"body.CannotInviteYourself\"\n}]);\n\ntour.register('totp_admin_invite', {\n    test: true,\n    url: '/web'\n}, [tour.stepUtils.showAppsMenuItem(), ...openAccountSettingsTab(), {\n    content: \"open the user's form\",\n    trigger: \"td.o_data_cell:contains(demo)\",\n}, {\n    content: \"go to Account security Tab\",\n    trigger: \"a.nav-link:contains(Account Security)\",\n}, {\n    content: \"check that demo user can be invited to use 2FA.\",\n    trigger: \"button:contains(Invite to use 2FA)\",\n}]);\n\n});", "odoo.define('auth_totp_portal.tours', function(require) {\n\"use strict\";\n\nconst tour = require('web_tour.tour');\nconst ajax = require('web.ajax');\n\ntour.register('totportal_tour_setup', {\n    test: true,\n    url: '/my/security'\n}, [{\n    content: \"Open totp wizard\",\n    trigger: 'button#auth_totp_portal_enable',\n}, {\n    content: \"Check that we have to enter enhanced security mode\",\n    trigger: 'div:contains(\"enter your password\")',\n    run: () => {},\n}, {\n    content: \"Input password\",\n    trigger: '[name=password]',\n    run: 'text portal', // FIXME: better way to do this?\n}, {\n    content: \"Confirm\",\n    trigger: \"button:contains(Confirm Password)\",\n}, {\n    content: \"Check the wizard has opened\",\n    trigger: 'li:contains(\"scan the barcode below\")',\n    run: () => {}\n}, {\n    content: \"Get secret from collapsed div\",\n    trigger: 'a:contains(\"Cannot scan it?\")',\n    run: async function(helpers) {\n        const secret = this.$anchor.closest('div').find('span[name=\"secret\"]').text();\n        const token = await ajax.jsonRpc('/totphook', 'call', {\n            secret\n        });\n        helpers._text(helpers._get_action_values('input[name=code]'), token);\n        helpers._click(helpers._get_action_values('button.btn-primary:contains(Activate)'));\n    }\n}, {\n    content: \"Check that the button has changed\",\n    trigger: 'button:contains(Disable two-factor authentication)',\n    run: () => {}\n}]);\n\ntour.register('totportal_login_enabled', {\n    test: true,\n    url: '/'\n}, [{\n    content: \"check that we're on the login page or go to it\",\n    trigger: 'input#login, a:contains(Sign in)'\n}, {\n    content: \"input login\",\n    trigger: 'input#login',\n    run: 'text portal',\n}, {\n    content: 'input password',\n    trigger: 'input#password',\n    run: 'text portal',\n}, {\n    content: \"click da button\",\n    trigger: 'button:contains(\"Log in\")',\n}, {\n    content: \"expect totp screen\",\n    trigger: 'label:contains(Authentication Code)',\n}, {\n    content: \"input code\",\n    trigger: 'input[name=totp_token]',\n    run: async function (helpers) {\n        const token = await ajax.jsonRpc('/totphook', 'call', {});\n        helpers._text(helpers._get_action_values(), token);\n        // FIXME: is there a way to put the button as its own step trigger without\n        //        the tour straight blowing through and not waiting for this?\n        helpers._click(helpers._get_action_values('button:contains(\"Login\")'));\n    }\n}, {\n    content: \"check we're logged in\",\n    trigger: \"h3:contains(Documents)\",\n    run: () => {}\n}, {\n    content: \"go back to security\",\n    trigger: \"a:contains(Security)\",\n},{\n    content: \"Open totp wizard\",\n    trigger: 'button#auth_totp_portal_disable',\n}, {\n    content: \"Check that we have to enter enhanced security mode\",\n    trigger: 'div:contains(\"enter your password\")',\n    run: () => {},\n}, {\n    content: \"Input password\",\n    trigger: '[name=password]',\n    run: 'text portal', // FIXME: better way to do this?\n}, {\n    content: \"Confirm\",\n    trigger: \"button:contains(Confirm Password)\",\n}, {\n    content: \"Check that the button has changed\",\n    trigger: 'button:contains(Enable two-factor authentication)',\n    run: () => {}\n}]);\n\ntour.register('totportal_login_disabled', {\n    test: true,\n    url: '/'\n}, [{\n    content: \"check that we're on the login page or go to it\",\n    trigger: 'input#login, a:contains(Sign in)'\n}, {\n    content: \"input login\",\n    trigger: 'input#login',\n    run: 'text portal',\n}, {\n    content: 'input password',\n    trigger: 'input#password',\n    run: 'text portal',\n}, {\n    content: \"click da button\",\n    trigger: 'button:contains(\"Log in\")',\n}, {\n    content: \"check we're logged in\",\n    trigger: \"h3:contains(Documents)\",\n    run: () => {}\n}]);\n});\n", "odoo.define(\"documents_spreadsheet.create_empty_sheet_tour\", function (require) {\n    \"use strict\";\n\n    require(\"web.dom_ready\");\n    const tour = require(\"web_tour.tour\");\n\n    tour.register(\n        \"spreadsheet_create_empty_sheet\",\n        {\n            test: true,\n        },\n        [\n            {\n                trigger: '.o_app[data-menu-xmlid=\"documents.menu_root\"]',\n                content: \"Open document app\",\n                run: \"click\",\n            },\n            {\n                trigger: \".o_documents_kanban_spreadsheet\",\n                content: \"Open template dialog\",\n                run: \"click\",\n            },\n            {\n                trigger: \".o-spreadsheet-create\",\n                content: \"Create new spreadsheet\",\n                run: \"click\",\n            },\n            {\n                trigger: 'span[title=\"Fill Color\"]',\n                content: \"Choose a color\",\n                run: \"click\",\n            },\n            {\n                trigger: '.o-color-picker .o-color-picker-line div[data-color=\"#990000\"]',\n                content: \"Choose a color\",\n                run: \"click\",\n            },\n            {\n                trigger: \".o_menu_brand\",\n                content: \"Go back to the menu\",\n                run: \"click\",\n            },\n            {\n                trigger: \".o_document_spreadsheet:first\",\n                content: \"Reopen the sheet\",\n                run: \"click\",\n            },\n        ]\n    );\n    tour.register(\n        \"spreadsheet_create_list_view\",\n        {\n            test: true,\n        },\n        [\n            {\n                trigger: '.o_app[data-menu-xmlid=\"documents.menu_root\"]',\n                content: \"Open document app\",\n                run: \"click\",\n            },\n            {\n                trigger: \"button.o_switch_view.o_list\",\n                content: \"Switch to list view\",\n                run: \"click\",\n            },\n            {\n                trigger: \".o_favorite_menu button\",\n                extra_trigger: \".o_list_view\",\n                content: \"Open the favorites menu\",\n                run: \"click\",\n            },\n            {\n                trigger: \".o_insert_list_spreadsheet_menu\",\n                content: \"Insert in spreadsheet\",\n                run: \"click\",\n            },\n            {\n                trigger: \".modal-footer .btn-primary\",\n                content: \"Confirm\",\n                run: \"click\",\n            },\n            {\n                trigger: \".o-topbar-topleft .o-topbar-menu[data-id='data']\",\n                content: \"Open Data menu\",\n                run: \"click\",\n            },\n            {\n                trigger: \".o-menu-item[data-name='item_list_1']\",\n                content: \"Open List Side Panel\",\n                run: \"click\",\n            },\n            {\n                trigger: \".o_pivot_cancel\",\n                content: \"Go back to the list of lists\",\n                run: \"click\",\n            },\n        ]\n    );\n});\n", "odoo.define('documents_spreadsheet.open_pivot_sheet_tour', function (require) {\n    'use strict';\n\n    require('web.dom_ready');\n    const tour = require('web_tour.tour');\n\n    function assert (current, expected, info) {\n        if (current !== expected) {\n            fail(info + ': \"' + current + '\" instead of \"' + expected + '\".');\n        }\n    }\n\n    function fail (errorMessage) {\n        tour._consume_tour(tour.running_tour, errorMessage);\n    }\n\n    const SHEETNAME = \"Partner Spreadsheet Test\"\n    tour.register('spreadsheet_open_pivot_sheet', {\n        test: true,\n    }, [\n        {\n            trigger: '.o_app[data-menu-xmlid=\"documents.menu_root\"]',\n            content: 'Open document app',\n            run: 'click',\n        },\n        {\n            trigger: `div[title=\"${SHEETNAME}\"]`,\n            content: 'Select Test Sheet',\n            run: 'click',\n        },\n        {\n            trigger: `img[title=\"${SHEETNAME}\"]`,\n            content: 'Open the sheet',\n            run: 'click',\n        },\n        {\n            trigger: 'div.o_topbar_filter_icon',\n            content: 'Open Filters',\n            run: \"click\"\n        },\n        {\n            trigger: 'div.pivot_filter',\n            content: '',\n            run: function (actions) {\n                const pivots = document.querySelectorAll(\"div.pivot_filter\")\n                assert(pivots.length, 1, \"There should be one filter\")\n                const pivot = pivots[0]\n                assert(pivot.querySelector('div.o_side_panel_title').textContent, \"MyFilter1\", \"Invalid filter name\")\n                assert(Boolean(pivot.querySelector('div.o_field_many2manytags div.badge[data-id=\"14\"]')), true, \"Wrong default filter value\")\n                actions.click(pivot.querySelector(\".o_side_panel_filter_icon\"))\n            }\n        },\n        {\n            trigger: '.o_spreadsheet_filter_editor_side_panel',\n            content: 'Check filter values',\n            run: function () {\n                const modelWidgetInputs = document.querySelectorAll(\"div.o_field_widget.o_field_many2one.o_quick_editable\")\n                assert(modelWidgetInputs.length, 2, \"There should be a default value in the filter...\")\n                assert(modelWidgetInputs[0].querySelector(\"input\").value, \"Contact\", \"Wrong model selected\")\n\n                const fieldsValue = document.querySelector(\"div.o_field_selector_value span.o_field_selector_chain_part\")\n                assert(fieldsValue.textContent.trim(), \"Related Company\")\n            }\n        },\n        {\n            trigger: '.o_menu_brand',\n            content: 'Go back to the menu',\n            run: 'click'\n        },\n        {\n            trigger: '.o_document_spreadsheet:first',\n            content: 'Reopen the sheet',\n            run: 'click'\n        },\n    ]);\n});\n", "/** @odoo-module **/\n\nimport tour from 'web_tour.tour';\n\n/**\n * This tour depends on data created by python test in charge of launching it.\n * It is not intended to work when launched from interface. It is needed to test\n * an action (action manager) which is not possible to test with QUnit.\n * @see mail_enterprise/tests/test_mail_channel_expand.py\n */\ntour.register('mail_enterprise/static/tests/tours/mail_channel_expand_test_tour.js', {\n    test: true,\n}, [{\n    content: \"Click on chat window header expand button to open channel in Discuss\",\n    trigger: '.o_ChatWindow:has(.o_ChatWindowHeader_name:contains(\"test-mail-channel-expand-tour\")) .o_ChatWindowHeader_commandExpand',\n}, {\n    content: \"Check that first message of #test-mail-channel-expand-tour is shown in Discuss app\",\n    trigger: '.o_Discuss .o_Message_content:contains(\"test-message-mail-channel-expand-tour\")',\n    run: () => {},\n}]);\n"], "file": "/web/assets/197-6c61e04/web.assets_tests.js", "sourceRoot": "../../../"}